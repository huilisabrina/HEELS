2023/01/13 12:53:18 PM 
<><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
<>
<> HEELS: Heritability Estimator with high Efficiency using LD and Summary Statistics 
<> Version: 0.0.1
<> (C) 2022 Hui Li, Rahul Mazumder and Xihong Lin
<> Harvard University Department of Biostatistics
<> MIT Sloan School of Management, Operations Research Center and Center for Statistics and Data Science
<> GNU General Public License v3
<><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
<> Note:  It is recommended to run your own QC on the input before using this program. 
<> Software-related correspondence: hui_li@g.harvard.edu 
<><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>


Calling ./run_HEELS.py \
--output-fp ./demo/output/test_h2 \
--sumstats-fp ./data/ukb_332k_simul_pheno.txt \
--bim-fp ./data/ukb_332k_chr22_maf01_geno1 \
--ld-fp ./data/ukb_332k_chr22_LD.npz \
--N 332340 \
--N-ref 332340 \
--stream-stdout  \
--init-values 0.1,0.9 \
--constrain-sigma  \
--calc-var  \
--tol 0.0001 

2023/01/13 12:53:18 PM Beginning HEELS analysis...
2023/01/13 12:53:18 PM Parsing the full LD matrix from file
2023/01/13 12:53:18 PM Single LD block (no partitioning)
2023/01/13 12:53:19 PM Dropped 0 SNP due to invalid LD information
2023/01/13 12:53:20 PM LD parsing is complete.
2023/01/13 12:53:20 PM Number of markers: 8298.
2023/01/13 12:53:20 PM <><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
2023/01/13 12:53:20 PM No low-dimensional LD decomposition is conducted.
2023/01/13 12:53:20 PM <><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
2023/01/13 12:53:20 PM Parsing summary statistics from file
2023/01/13 12:53:20 PM Number of SNPs in sumstats: 8298
2023/01/13 12:53:20 PM Aligning sumstats with LD info and selecting overlapped markers only
2023/01/13 12:53:20 PM Number of SNPs in the LD: 8298
2023/01/13 12:53:20 PM Number of SNPs overlapped between sumstats and LD 8298
2023/01/13 12:53:20 PM <><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
2023/01/13 12:53:20 PM Preparing the Z-scores for running HEELS and adjust if necessary
2023/01/13 12:53:20 PM <><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
2023/01/13 12:53:20 PM Start running HEELS
2023/01/13 12:53:20 PM HEELS procedure started at Fri Jan 13 12:53:20 2023
2023/01/13 12:53:20 PM Iteration: 0
2023/01/13 12:53:42 PM Trace term: 398.2565254924351
2023/01/13 12:53:42 PM Using sample variance of 1.0 to update sigma_e^2
2023/01/13 12:53:42 PM Rescaling updated values s.t. sigma_g^2 + sigma_e^2 = 1
2023/01/13 12:53:42 PM Current sigma_g: 0.17090812892657278 

2023/01/13 12:53:42 PM Current sigma_e: 0.8290918710734273 

2023/01/13 12:53:42 PM Difference in sigma_g: 0.07090812892657278 

2023/01/13 12:53:42 PM Difference in sigma_e: -0.07090812892657272 

2023/01/13 12:53:42 PM Current Z-logL value: 32183.80319932371 

2023/01/13 12:53:42 PM Delta logL: 32683.80319932371 

2023/01/13 12:53:42 PM Iteration: 1
2023/01/13 12:54:03 PM Trace term: 578.2350789279766
2023/01/13 12:54:03 PM Using sample variance of 1.0 to update sigma_e^2
2023/01/13 12:54:03 PM Rescaling updated values s.t. sigma_g^2 + sigma_e^2 = 1
2023/01/13 12:54:03 PM Current sigma_g: 0.21701737050191156 

2023/01/13 12:54:03 PM Current sigma_e: 0.7829826294980885 

2023/01/13 12:54:03 PM Difference in sigma_g: 0.04610924157533877 

2023/01/13 12:54:03 PM Difference in sigma_e: -0.0461092415753388 

2023/01/13 12:54:03 PM Current Z-logL value: 32895.74963376682 

2023/01/13 12:54:03 PM Delta logL: 711.9464344431108 

2023/01/13 12:54:03 PM Iteration: 2
2023/01/13 12:54:25 PM Trace term: 682.2893569903205
2023/01/13 12:54:25 PM Using sample variance of 1.0 to update sigma_e^2
2023/01/13 12:54:25 PM Rescaling updated values s.t. sigma_g^2 + sigma_e^2 = 1
2023/01/13 12:54:25 PM Current sigma_g: 0.23805968764143048 

2023/01/13 12:54:25 PM Current sigma_e: 0.7619403123585695 

2023/01/13 12:54:25 PM Difference in sigma_g: 0.02104231713951893 

2023/01/13 12:54:25 PM Difference in sigma_e: -0.021042317139518985 

2023/01/13 12:54:25 PM Current Z-logL value: 32894.88503240851 

2023/01/13 12:54:25 PM Delta logL: -0.8646013583129388 

2023/01/13 12:54:25 PM Iteration: 3
2023/01/13 12:54:47 PM Trace term: 727.7465991971206
2023/01/13 12:54:47 PM Using sample variance of 1.0 to update sigma_e^2
2023/01/13 12:54:47 PM Rescaling updated values s.t. sigma_g^2 + sigma_e^2 = 1
2023/01/13 12:54:47 PM Current sigma_g: 0.2462301911223642 

2023/01/13 12:54:47 PM Current sigma_e: 0.7537698088776359 

2023/01/13 12:54:47 PM Difference in sigma_g: 0.008170503480933705 

2023/01/13 12:54:47 PM Difference in sigma_e: -0.008170503480933622 

2023/01/13 12:54:47 PM Current Z-logL value: 32838.97848558086 

2023/01/13 12:54:47 PM Delta logL: -55.9065468276458 

2023/01/13 12:54:47 PM Iteration: 4
2023/01/13 12:55:08 PM Trace term: 745.1358079748612
2023/01/13 12:55:08 PM Using sample variance of 1.0 to update sigma_e^2
2023/01/13 12:55:08 PM Rescaling updated values s.t. sigma_g^2 + sigma_e^2 = 1
2023/01/13 12:55:08 PM Current sigma_g: 0.24920832959904302 

2023/01/13 12:55:08 PM Current sigma_e: 0.750791670400957 

2023/01/13 12:55:08 PM Difference in sigma_g: 0.0029781384766788266 

2023/01/13 12:55:08 PM Difference in sigma_e: -0.0029781384766789376 

2023/01/13 12:55:08 PM Current Z-logL value: 32810.53746999144 

2023/01/13 12:55:08 PM Delta logL: -28.441015589422022 

2023/01/13 12:55:08 PM Iteration: 5
2023/01/13 12:55:30 PM Trace term: 751.4418181943763
2023/01/13 12:55:30 PM Using sample variance of 1.0 to update sigma_e^2
2023/01/13 12:55:30 PM Rescaling updated values s.t. sigma_g^2 + sigma_e^2 = 1
2023/01/13 12:55:30 PM Current sigma_g: 0.2502690239922294 

2023/01/13 12:55:30 PM Current sigma_e: 0.7497309760077706 

2023/01/13 12:55:30 PM Difference in sigma_g: 0.0010606943931863733 

2023/01/13 12:55:30 PM Difference in sigma_e: -0.0010606943931863455 

2023/01/13 12:55:30 PM Current Z-logL value: 32799.34308732691 

2023/01/13 12:55:30 PM Delta logL: -11.194382664529257 

2023/01/13 12:55:30 PM Iteration: 6
2023/01/13 12:55:52 PM Trace term: 753.6837795075625
2023/01/13 12:55:52 PM Using sample variance of 1.0 to update sigma_e^2
2023/01/13 12:55:52 PM Rescaling updated values s.t. sigma_g^2 + sigma_e^2 = 1
2023/01/13 12:55:52 PM Current sigma_g: 0.2506436950493586 

2023/01/13 12:55:52 PM Current sigma_e: 0.7493563049506413 

2023/01/13 12:55:52 PM Difference in sigma_g: 0.00037467105712918336 

2023/01/13 12:55:52 PM Difference in sigma_e: -0.0003746710571292944 

2023/01/13 12:55:52 PM Current Z-logL value: 32795.253927952646 

2023/01/13 12:55:52 PM Delta logL: -4.089159374263545 

2023/01/13 12:55:52 PM Iteration: 7
2023/01/13 12:56:14 PM Trace term: 754.4752191003231
2023/01/13 12:56:14 PM Using sample variance of 1.0 to update sigma_e^2
2023/01/13 12:56:14 PM Rescaling updated values s.t. sigma_g^2 + sigma_e^2 = 1
2023/01/13 12:56:14 PM Current sigma_g: 0.250775655182851 

2023/01/13 12:56:14 PM Current sigma_e: 0.7492243448171492 

2023/01/13 12:56:14 PM Difference in sigma_g: 0.00013196013349242586 

2023/01/13 12:56:14 PM Difference in sigma_e: -0.0001319601334921483 

2023/01/13 12:56:14 PM Current Z-logL value: 32793.79688041219 

2023/01/13 12:56:14 PM Delta logL: -1.4570475404543686 

2023/01/13 12:56:14 PM Iteration: 8
2023/01/13 12:56:35 PM Trace term: 754.7539053307921
2023/01/13 12:56:35 PM Using sample variance of 1.0 to update sigma_e^2
2023/01/13 12:56:35 PM Rescaling updated values s.t. sigma_g^2 + sigma_e^2 = 1
2023/01/13 12:56:35 PM Current sigma_g: 0.25082208413856977 

2023/01/13 12:56:35 PM Current sigma_e: 0.7491779158614303 

2023/01/13 12:56:35 PM Difference in sigma_g: 4.642895571876915e-05 

2023/01/13 12:56:35 PM Difference in sigma_e: -4.642895571882466e-05 

2023/01/13 12:56:35 PM Current Z-logL value: 32793.28214345075 

2023/01/13 12:56:35 PM Delta logL: -0.5147369614423951 

2023/01/13 12:56:35 PM Iteration: 9
2023/01/13 12:56:57 PM Trace term: 754.8519509836613
2023/01/13 12:56:57 PM Using sample variance of 1.0 to update sigma_e^2
2023/01/13 12:56:57 PM Rescaling updated values s.t. sigma_g^2 + sigma_e^2 = 1
2023/01/13 12:56:57 PM Current sigma_g: 0.250838413830839 

2023/01/13 12:56:57 PM Current sigma_e: 0.7491615861691608 

2023/01/13 12:56:57 PM Difference in sigma_g: 1.632969226922354e-05 

2023/01/13 12:56:57 PM Difference in sigma_e: -1.6329692269501095e-05 

2023/01/13 12:56:57 PM Current Z-logL value: 32793.100844990535 

2023/01/13 12:56:57 PM Delta logL: -0.18129846021474805 

2023/01/13 12:56:57 PM Iteration: 10
2023/01/13 12:57:18 PM Trace term: 754.8864340364557
2023/01/13 12:57:18 PM Using sample variance of 1.0 to update sigma_e^2
2023/01/13 12:57:18 PM Rescaling updated values s.t. sigma_g^2 + sigma_e^2 = 1
2023/01/13 12:57:18 PM Current sigma_g: 0.25084415647406166 

2023/01/13 12:57:18 PM Current sigma_e: 0.7491558435259384 

2023/01/13 12:57:18 PM Difference in sigma_g: 5.742643222672594e-06 

2023/01/13 12:57:18 PM Difference in sigma_e: -5.7426432223950385e-06 

2023/01/13 12:57:18 PM Current Z-logL value: 32793.037056002 

2023/01/13 12:57:18 PM Delta logL: -0.06378898853290593 

2023/01/13 12:57:18 PM Iteration: 11
2023/01/13 12:57:40 PM Trace term: 754.8985605350477
2023/01/13 12:57:40 PM Using sample variance of 1.0 to update sigma_e^2
2023/01/13 12:57:40 PM Rescaling updated values s.t. sigma_g^2 + sigma_e^2 = 1
2023/01/13 12:57:40 PM Current sigma_g: 0.2508461758921421 

2023/01/13 12:57:40 PM Current sigma_e: 0.7491538241078578 

2023/01/13 12:57:40 PM Difference in sigma_g: 2.0194180804233852e-06 

2023/01/13 12:57:40 PM Difference in sigma_e: -2.01941808064543e-06 

2023/01/13 12:57:40 PM Current Z-logL value: 32793.01462045414 

2023/01/13 12:57:40 PM Delta logL: -0.022435547864006367 

2023/01/13 12:57:40 PM Iteration: 12
2023/01/13 12:58:02 PM Trace term: 754.9028248411952
2023/01/13 12:58:02 PM Using sample variance of 1.0 to update sigma_e^2
2023/01/13 12:58:02 PM Rescaling updated values s.t. sigma_g^2 + sigma_e^2 = 1
2023/01/13 12:58:02 PM Current sigma_g: 0.2508468860155237 

2023/01/13 12:58:02 PM Current sigma_e: 0.7491531139844761 

2023/01/13 12:58:02 PM Difference in sigma_g: 7.101233815975938e-07 

2023/01/13 12:58:02 PM Difference in sigma_e: -7.10123381653105e-07 

2023/01/13 12:58:02 PM Current Z-logL value: 32793.00673056009 

2023/01/13 12:58:02 PM Delta logL: -0.007889894048275892 

2023/01/13 12:58:02 PM Iteration: 13
2023/01/13 12:58:24 PM Trace term: 754.9043243721627
2023/01/13 12:58:24 PM Using sample variance of 1.0 to update sigma_e^2
2023/01/13 12:58:24 PM Rescaling updated values s.t. sigma_g^2 + sigma_e^2 = 1
2023/01/13 12:58:24 PM Current sigma_g: 0.2508471357272759 

2023/01/13 12:58:24 PM Current sigma_e: 0.7491528642727241 

2023/01/13 12:58:24 PM Difference in sigma_g: 2.497117522204384e-07 

2023/01/13 12:58:24 PM Difference in sigma_e: -2.4971175205390495e-07 

2023/01/13 12:58:24 PM Current Z-logL value: 32793.00395605321 

2023/01/13 12:58:24 PM Delta logL: -0.0027745068800868466 

2023/01/13 12:58:24 PM Iteration: 14
2023/01/13 12:58:45 PM Trace term: 754.9048516753898
2023/01/13 12:58:45 PM Using sample variance of 1.0 to update sigma_e^2
2023/01/13 12:58:45 PM Rescaling updated values s.t. sigma_g^2 + sigma_e^2 = 1
2023/01/13 12:58:45 PM Current sigma_g: 0.2508472235371404 

2023/01/13 12:58:45 PM Current sigma_e: 0.7491527764628597 

2023/01/13 12:58:45 PM Difference in sigma_g: 8.780986449075101e-08 

2023/01/13 12:58:45 PM Difference in sigma_e: -8.780986437972871e-08 

2023/01/13 12:58:45 PM Current Z-logL value: 32793.00298040453 

2023/01/13 12:58:45 PM Delta logL: -0.0009756486761034466 

2023/01/13 12:58:45 PM Iteration: 15
2023/01/13 12:59:07 PM Trace term: 754.9050370988538
2023/01/13 12:59:07 PM Using sample variance of 1.0 to update sigma_e^2
2023/01/13 12:59:07 PM Rescaling updated values s.t. sigma_g^2 + sigma_e^2 = 1
2023/01/13 12:59:07 PM Current sigma_g: 0.2508472544150104 

2023/01/13 12:59:07 PM Current sigma_e: 0.7491527455849896 

2023/01/13 12:59:07 PM Difference in sigma_g: 3.0877869983125805e-08 

2023/01/13 12:59:07 PM Difference in sigma_e: -3.087787014965926e-08 

2023/01/13 12:59:07 PM Current Z-logL value: 32793.002637321944 

2023/01/13 12:59:07 PM Delta logL: -0.00034308258909732103 

2023/01/13 12:59:07 PM Iteration: 16
2023/01/13 12:59:29 PM Trace term: 754.9051023020223
2023/01/13 12:59:29 PM Using sample variance of 1.0 to update sigma_e^2
2023/01/13 12:59:29 PM Rescaling updated values s.t. sigma_g^2 + sigma_e^2 = 1
2023/01/13 12:59:29 PM Current sigma_g: 0.25084726527304585 

2023/01/13 12:59:29 PM Current sigma_e: 0.7491527347269541 

2023/01/13 12:59:29 PM Difference in sigma_g: 1.0858035470739935e-08 

2023/01/13 12:59:29 PM Difference in sigma_e: -1.0858035470739935e-08 

2023/01/13 12:59:29 PM Current Z-logL value: 32793.00251667872 

2023/01/13 12:59:29 PM Delta logL: -0.00012064322072546929 

2023/01/13 12:59:29 PM Iteration: 17
2023/01/13 12:59:50 PM Trace term: 754.9051252303623
2023/01/13 12:59:50 PM Using sample variance of 1.0 to update sigma_e^2
2023/01/13 12:59:50 PM Rescaling updated values s.t. sigma_g^2 + sigma_e^2 = 1
2023/01/13 12:59:50 PM Current sigma_g: 0.2508472690912149 

2023/01/13 12:59:50 PM Current sigma_e: 0.7491527309087851 

2023/01/13 12:59:50 PM Difference in sigma_g: 3.818169058700249e-09 

2023/01/13 12:59:50 PM Difference in sigma_e: -3.818169003189098e-09 

2023/01/13 12:59:50 PM Current Z-logL value: 32793.00247425517 

2023/01/13 12:59:50 PM Delta logL: -4.242355498718098e-05 

2023/01/13 12:59:50 PM Time elapsed in seconds: 390.2
2023/01/13 12:59:50 PM Time elapsed for iterative procedure: 6.0m:30.19999999999999s
2023/01/13 12:59:50 PM Number of iterations: 18
2023/01/13 12:59:50 PM Finish running HEELS. Writing results into file.
2023/01/13 12:59:50 PM <><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
2023/01/13 12:59:50 PM <><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
2023/01/13 12:59:50 PM Computing the variance of HEELS estimator
2023/01/13 01:00:12 PM Calculating the SE using the analytical form (ll based)
2023/01/13 01:00:12 PM Used eigvals
2023/01/13 01:00:12 PM [7.760e-02 8.790e-02 9.514e-02 ... 8.850e+02 8.909e+02 1.236e+03]
2023/01/13 01:00:12 PM HEELS SE of h2: 0.0038106567729466467
2023/01/13 01:00:12 PM HEELS Asymptotic SE of sigma_g: 0.005031779303242718
2023/01/13 01:00:12 PM HEELS Asymptotic SE of sigma_e: 0.0018604170791542973
2023/01/13 01:00:12 PM HEELS Asymptotic SE of h^2: 0.0038106567729466467
2023/01/13 01:00:12 PM Total time elapsed: 6.0m:54.00877928733826s
2023/01/13 01:00:12 PM <><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
